// Deterministic Build Example
// Demonstrates Builder's determinism enforcement beyond hermeticity

target("demo-app") {
    type: executable;
    language: c;
    sources: ["main.c"];
    
    // Enable determinism enforcement via compiler flags
    // Note: Native determinism config field coming in future version
    
    // Compiler flags for determinism
    flags: [
        "-frandom-seed=42",
        "-ffile-prefix-map=$(pwd)=.",
        "-fdebug-prefix-map=$(pwd)=."
    ];
    
    env: {
        "SOURCE_DATE_EPOCH": "1640995200"
    };
}

target("non-deterministic-app") {
    type: executable;
    language: c;
    sources: ["non_deterministic.c"];
    
    // Deliberately non-deterministic for comparison (no fixed flags)
}

// Note: Custom verification target removed for now
// Future: Re-enable when custom command execution is fully supported
// target("verify-determinism") {
//     type: custom;
//     command: "bldr verify //demo-app:demo-app --iterations=5";
//     deps: ["//demo-app:demo-app"];
// }

